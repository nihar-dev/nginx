<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
      </script>
      <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
      </script>

    <title>Generic Optimisation</title>
    <style>
      body{
        background: #ADA996;  /* fallback for old browsers */
        background: -webkit-linear-gradient(to right, #EAEAEA, #DBDBDB, #F2F2F2, #ADA996);  /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(to right, #EAEAEA, #DBDBDB, #F2F2F2, #ADA996); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */

      }
      .vl {
        margin-top: 10px;
        border-left: 6px solid  #ADA996;
      }
      .text_styl{
        margin-left: 10px;
      }

    </style>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-dark "  style="background-color: #ADA996;">
        <div class="container-fluid">
          <a class="navbar-brand" href="/"><p class="h3">Generic Optimization</p></a>
        </div>
      </nav>
        <h4 class="vl">
          <small class="text-muted text_styl">Please enter variable count</small>
        </h4>

        <div class="card">

          <div class="card-body">
            <div class="col-md-2">
              <div class="input-group mb-3">
                  <input type="text" class="form-control " id="variable_count" placeholder="variable eg: 1,2,3.." aria-label="eg: 1,2,3..">
              </div>
            </div>

            <div id="spinner_variable" class="d-flex justify-content-center" style="display: none !important;" ;>
                <div class="spinner-grow" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
                </div>
            </div>
          </div>

          <h4 class="vl">
            <small class="text-muted text_styl">Equation</small>
              </h4>

          <div class="card">

            <div class="card-body">

          <form class="row g-3 align-items-center" id="math-function">
          </form>
          <div class="d-grid gap-2 d-md-flex justify-content-md-center">
          <button type="submit" id= "form-submit" style="display: none ; margin-top: 10px;" class="btn btn-outline-secondary mb-2">Submit</button>
          
          <div class="spinner-border m-3" id='eq_spnr' style="display: none ;" role="status">
            <span class="sr-only"></span>
          </div>

            <p id='success_message_eq' style="display: none ; margin-top: 20px;" ><em></em></p>

          </div>

          </div>
        </div>

          <h4 class="vl">
        <small class="text-muted text_styl">Bound and Constraints</small>
          </h4>

        <div class="card">
          <div class="card-body">

            <div class="row">

              <div class="col-2"  >
                <div id='bound_scroll' style="height: 250px; overflow-y: scroll;">

                </div>
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                    <button  id = "button1"
                    type="button" class="btn btn-outline-secondary mb-2"  > Apply </button>
                 </div>
              </div>
              <div class="col-6">
                <div id="main_content_for_bound">
                  
                </div>
              </div>
              <div class="col-4">
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                  <button type="submit" id= "form-submit-bound" style="display: none; margin-top: 100px; " class="btn btn-outline-secondary mb-2"> Add Constraints</button>
                  </div>
              </div>

            </div>

          </div>

        </div>

      </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
  
  <script>
$( document ).ready(function() {
  $("#variable_count").change(function() {   
        // $("#spinner_variable").show();
        console.log( "variable count: ",$(this).val());
        var variablecount  = $(this).val();

        // ---------------------------------------------------------
        variable_string = '';
        dynamic_html  =``;
        if(variablecount > 0){
          for(var i=1;i<=variablecount;i++){
            dynamic_html = dynamic_html.concat(`
            <div class="col-sm-1">
              <input type="text"  name='denoted' class="form-control form-control-sm" id=${'_' + Math.random().toString(36).substr(2, 9)} placeholder=" ">
            </div>
            <div class="col-auto">
              <label for="staticEmail2">${ 'X'+i+'^'}</label>
            </div>
              <div class="col-sm-1">
              <input type="text"  name='power' class="form-control form-control-sm" id=${'_' + Math.random().toString(36).substr(2, 9)} placeholder=" ">
            </div>
              <div class="col-auto">
              <label for="staticEmail2" >${i==variablecount? ' ' :  ' + ' }</label>
            </div>
            
            `)
          }
          
        }
        console.log(variable_string);
        var $el = $('#math-function');
        $el.empty();
        $el.append(dynamic_html);

        $("#form-submit").show();
        // ---------------------------------------------------------------

        // bound_scroll
        dynamic_html_bound  =``;
        if(variablecount > 0){
          for(var i=1;i<=variablecount;i++){
            dynamic_html_bound = dynamic_html_bound.concat(`
            <div class="form-check">
              <input class="form-check-input" name='values' type="checkbox" value=${'x'+i} id=${'X'+i+'b'}>
              <label class="form-check-label" for="flexCheckDefault">
                ${'X'+i}
              </label>
            </div>            
            `)
          }
          
        }
        console.log(variable_string);
        var $var_bound = $('#bound_scroll');
        $var_bound.empty();
        $var_bound.append(dynamic_html_bound);
        $("#form-submit-bound").show();
   
    });

});


  </script>

<script>
  $("#form-submit").on("click", function(){
    var denoted = [];
    var power = [];
    $("#eq_spnr").show();
    $('#math-function input, #math-function select').each(
    function(index){  
          var input = $(this);
          if (input.attr('name') == 'denoted'){
            denoted.push(parseInt(input.val()));
          }else{
            power.push(parseInt(input.val()));
          }
 
        }
      );
      var datav = JSON.stringify({'denoted':denoted,'power':power});
    $.ajax({
        type: 'POST',
        contentType: 'application/json',
        url: '/post/data',
        dataType : 'json',
        data:datav,
        url: "/equation",
        success: function(data){
          $("#eq_spnr").hide();
          $("#success_message_eq").html('');
          if(data.code == 200){
            $("#success_message_eq").html(data.message);
            $("#success_message_eq").show();
            console.log(data.message);
          }
          else if(data.code == 400){
            $("#success_message_eq").html(data.message);
            $("#success_message_eq").show();
            console.log(data.message);
          }
          var buf1=data;
          console.log(data);
        }
    })

});
</script>



<!-- below bund and constraints check box value dynamic section -->
<script>
  $(document).ready(function(){
    $("#button1").click(function() {
        var arr=[];
        var p=$("#main_content_for_bound");
        $(p).html("you have selected:");
        $.each($("input[name='values']:checked"), function() {
            // $(p).html($(p).html() + '<br>' + $(this).val());
            arr.push($(this).val());
          // console.log($(this).val());

        });
        $(p).html($(p).html() + '<br>' + arr.join(':') );
        // $('#main_content_for_bound').val(arr.join(':'));      
    }); 
});
</script>


  </body>
</html>
